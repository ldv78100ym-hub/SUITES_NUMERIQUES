<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cours et Exercices Dynamiques : Les Suites Arithm√©tiques (Al√©atoires)</title>
    
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #64748b;
            --bg-sidebar: #1e293b;
            --bg-main: #f8fafc;
            --text-dark: #0f172a;
            --text-light: #f1f5f9;
            --accent: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-main);
            height: 100vh;
            overflow: hidden;
            display: flex;
        }

        .sidebar {
            width: 280px;
            background: var(--bg-sidebar);
            color: var(--text-light);
            display: flex;
            flex-direction: column;
            box-shadow: 2px 0 10px rgba(0,0,0,0.3);
            z-index: 10;
            flex-shrink: 0;
        }

        .sidebar-header {
            padding: 20px;
            background: rgba(0,0,0,0.2);
            border-bottom: 2px solid var(--primary);
        }

        .sidebar-header h2 {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .exercise-list {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }

        .exercise-item {
            padding: 15px;
            margin-bottom: 8px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .exercise-item:hover {
            background: rgba(255,255,255,0.1);
            transform: translateX(5px);
        }

        .exercise-item.active {
            background: var(--primary);
            border-left-color: var(--accent);
            font-weight: 600;
        }

        .exercise-number {
            display: inline-block;
            background: var(--accent);
            color: var(--text-dark);
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-right: 8px;
            font-weight: bold;
        }

        .sidebar-footer {
            padding: 15px;
            border-top: 1px solid rgba(255,255,255,0.1);
            font-size: 0.8rem;
            color: rgba(255,255,255,0.5);
            text-align: center;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
            min-width: 0;
        }

        .top-bar {
            background: white;
            padding: 20px 40px;
            box-shadow: var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 5;
            flex-shrink: 0;
        }

        .top-bar h1 {
            color: var(--text-dark);
            font-size: 1.5rem;
            font-weight: 300;
        }

        .top-bar h1 strong {
            color: var(--primary);
            font-weight: 700;
        }

        .controls {
            display: flex;
            gap: 15px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: var(--shadow);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(37, 99, 235, 0.3);
        }

        .btn-secondary {
            background: white;
            color: var(--secondary);
            border: 2px solid var(--secondary);
        }

        .btn-secondary:hover {
            background: var(--secondary);
            color: white;
        }

        .btn-accent {
            background: var(--accent);
            color: var(--text-dark);
            border: 2px solid var(--accent);
        }

        .btn-accent:hover {
            background: #d97706;
            transform: translateY(-2px);
        }

        .random-indicator {
            position: absolute;
            top: 20px;
            right: 40px;
            background: rgba(245, 158, 11, 0.1);
            color: var(--accent);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 2px solid var(--accent);
        }

        .slide-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 40px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            position: relative;
            overflow: hidden;
        }

        .slide {
            background: white;
            width: 100%;
            height: 100%;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 50px 60px;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            position: relative;
        }

        .slide::-webkit-scrollbar {
            width: 10px;
        }

        .slide::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 8px;
        }

        .slide::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 8px;
            border: 2px solid white;
        }

        .slide::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        .slide-header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid var(--primary);
            flex-shrink: 0;
        }

        .slide-category {
            display: inline-block;
            background: var(--accent);
            color: var(--text-dark);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .slide h2 {
            font-size: 2.2rem;
            color: var(--text-dark);
            line-height: 1.2;
            font-weight: 700;
        }

        .slide-content {
            flex: 1;
            font-size: 1.3rem;
            line-height: 1.7;
            color: var(--text-dark);
            overflow-y: visible;
        }

        .slide-content p {
            margin-bottom: 20px;
        }

        .math-block {
            background: #f1f5f9;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid var(--primary);
            font-size: 1.2rem;
            overflow-x: auto;
        }

        .graph-container {
            background: #ffffff;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .navigation-hint {
            position: absolute;
            bottom: 30px;
            right: 60px;
            color: var(--secondary);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255,255,255,0.9);
            padding: 10px 20px;
            border-radius: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            z-index: 10;
        }

        .nav-arrow {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            font-size: 1.2rem;
        }

        .nav-arrow:hover {
            background: var(--primary-dark);
            transform: scale(1.1);
        }

        .nav-arrow:disabled {
            background: #cbd5e1;
            cursor: not-allowed;
            transform: none;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
            opacity: 1;
        }

        .modal {
            background: white;
            border-radius: 16px;
            width: 90%;
            max-width: 800px;
            max-height: 85vh;
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            transform: scale(0.9);
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .modal-overlay.active .modal {
            transform: scale(1);
        }

        .modal-header {
            background: var(--primary);
            color: white;
            padding: 25px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }

        .modal-header h3 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .modal-close {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .modal-close:hover {
            background: rgba(255,255,255,0.3);
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 30px;
            overflow-y: auto;
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--text-dark);
        }

        .solution-step {
            margin-bottom: 20px;
            padding-left: 20px;
            border-left: 3px solid var(--success);
        }

        .solution-step h4 {
            color: var(--success);
            margin-bottom: 10px;
            font-weight: 600;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide {
            animation: fadeIn 0.4s ease;
        }

        @media (max-width: 1024px) {
            .sidebar { width: 260px; }
            .slide { padding: 40px; }
            .slide h2 { font-size: 1.8rem; }
            .slide-content { font-size: 1.1rem; }
        }

        @media (max-width: 768px) {
            body { flex-direction: column; }
            .sidebar { width: 100%; height: auto; max-height: 35vh; }
            .slide-container { padding: 20px; }
            .slide { padding: 30px; }
            .navigation-hint { right: 30px; bottom: 20px; }
            .controls { flex-wrap: wrap; }
        }
    </style>
</head>
<body>

    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>üìö Menu des Exercices</h2>
        </div>
        <div class="exercise-list" id="exerciseList">
        </div>
        <div class="sidebar-footer">
            Suites Arithm√©tiques Al√©atoires ¬© 2025
        </div>
    </aside>

    <main class="main-content">
        <div class="top-bar">
            <h1><strong>Math√©matiques</strong> | Suites Arithm√©tiques Dynamiques</h1>
            <div class="controls">
                <button class="btn btn-accent" onclick="regenerateAll()">
                    <span>üé≤</span> Nouvelles valeurs
                </button>
                <button class="btn btn-secondary" onclick="openCopyright()">
                    <span>‚öñÔ∏è</span> Droits d'auteur
                </button>
                <button class="btn btn-primary" onclick="openSolution()">
                    <span>üí°</span> Voir la solution
                </button>
            </div>
        </div>

        <div class="slide-container">
            
            <div class="slide" id="currentSlide">
            </div>
            <div class="navigation-hint">
                <span>Navigation :</span>
                <button class="nav-arrow" onclick="prevExercise()" id="btnPrev">‚Üê</button>
                <button class="nav-arrow" onclick="nextExercise()" id="btnNext">‚Üí</button>
            </div>
        </div>
    </main>

    <div class="modal-overlay" id="solutionModal">
        <div class="modal">
            <div class="modal-header">
                <h3>üí° Solution d√©taill√©e</h3>
                <button class="modal-close" onclick="closeModal('solutionModal')">&times;</button>
            </div>
            <div class="modal-body" id="solutionContent">
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="copyrightModal">
        <div class="modal">
            <div class="modal-header" style="background: #1e293b;">
                <h3>‚öñÔ∏è Droits d'Auteur et Licence d'Utilisation</h3>
                <button class="modal-close" onclick="closeModal('copyrightModal')">&times;</button>
            </div>
            <div class="modal-body" style="font-size: 0.95rem; line-height: 1.6;">
                <p><strong>Auteur :</strong> Yann Merdy (yann.merdy@gmail.com) - Janvier 2026</p>
                
                <h4 style="color: var(--primary); margin: 20px 0 10px 0;">Licence d'Utilisation Non Commerciale</h4>
                
                <p>Ce code HTML/CSS/JavaScript ainsi que le contenu g√©n√©r√© par l'application ("Cours et Exercices Dynamiques : Les √âvolutions") sont la propri√©t√© intellectuelle exclusive de l'auteur, Yann Merdy.</p>
                
                <h4 style="color: var(--success); margin: 20px 0 10px 0;">Conditions :</h4>
                
                <p><strong>Utilisation Priv√©e et √âducative (Autoris√©e) :</strong> Vous √™tes autoris√©.e √† utiliser, copier, modifier et distribuer ce code et son contenu uniquement √† des fins personnelles, √©ducatives et non lucratives.</p>
                
                <p><strong>Utilisation Commerciale (Interdite) :</strong> Toute utilisation, distribution, int√©gration ou reproduction du code ou du contenu (total ou partiel) √† des fins commerciales, lucratives ou professionnelles est strictement interdite sans un accord √©crit pr√©alable et explicite de l'auteur.</p>
                
                <p><strong>Attribution :</strong> Toute reproduction ou modification doit conserver la mention de l'auteur originale (Yann Merdy) et la pr√©sente notice de droits d'auteur.</p>
                
                <p style="margin-top: 20px; padding: 15px; background: #f1f5f9; border-radius: 8px;">
                    Pour toute demande d'utilisation commerciale ou de licence sp√©cifique, veuillez contacter l'auteur √† l'adresse indiqu√©e ci-dessus.
                </p>
            </div>
        </div>
    </div>

    <script>
        // Stockage des valeurs al√©atoires actuelles
        let currentValues = {};
        let currentExercise = 0;

        // Fonctions utilitaires pour g√©n√©rer des nombres al√©atoires
        const rand = {
            int: (min, max) => Math.floor(Math.random() * (max - min + 1)) + min,
            choice: (arr) => arr[Math.floor(Math.random() * arr.length)],
            shuffle: (arr) => {
                const newArr = [...arr];
                for (let i = newArr.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [newArr[i], newArr[j]] = [newArr[j], newArr[i]];
                }
                return newArr;
            },
            // G√©n√®re un multiple de step entre min et max
            multiple: (min, max, step) => {
                const steps = Math.floor((max - min) / step);
                return min + Math.floor(Math.random() * (steps + 1)) * step;
            }
        };

        // G√©n√©rateurs de valeurs al√©atoires pour chaque exercice
        const generators = {
            1: () => {
                // EXERCICE 1 : 2/3 chance d'√™tre arithm√©tique, 1/3 non
                const isArithmetic = Math.random() < 0.666;
                
                if (isArithmetic) {
                    // Suite arithm√©tique : population avec croissance constante
                    const u0 = rand.int(2, 10);
                    const r = rand.int(2, 5);
                    return {
                        isArithmetic: true,
                        u0, r,
                        u1: u0 + r,
                        u2: u0 + 2*r,
                        u3: u0 + 3*r,
                        diff1: r,
                        diff2: r
                    };
                } else {
                    // Suite g√©om√©trique : population avec croissance exponentielle
                    const u0 = rand.int(1, 5);
                    const q = rand.int(2, 4);
                    return {
                        isArithmetic: false,
                        u0, q,
                        u1: u0 * q,
                        u2: u0 * q * q,
                        u3: u0 * q * q * q,
                        diff1: u0 * (q - 1),
                        diff2: u0 * q * (q - 1)
                    };
                }
            },
            2: () => {
                // Ex 2: D√©pr√©ciation lin√©aire
                const duree = rand.int(4, 8);
                const depreciation = rand.multiple(2000, 15000, 1000);
                const initial = depreciation * duree;
                const annees = rand.int(2, duree - 1);
                return { initial, duree, depreciation, annees };
            },
            3: () => {
                // Ex 3: Remboursement dette
                const mensualite = rand.multiple(100, 500, 50);
                const moisTotal = rand.int(24, 60);
                const initial = mensualite * moisTotal;
                const mois1 = rand.int(5, 15);
                const mois2 = rand.int(20, 40);
                return { initial, mensualite, moisTotal, mois1, mois2 };
            },
            4: () => {
                // Ex 4: Temp√©rature altitude
                const gradient = (rand.int(5, 10) / 10);
                const temp0 = rand.int(15, 25);
                const alt1 = rand.int(5, 15);
                const alt2 = rand.int(16, 25);
                return { gradient, temp0, alt1, alt2 };
            },
            5: () => {
                // Ex 5: Training sportif
                const depart = rand.int(10, 20);
                const increment = rand.int(2, 5);
                const duree = rand.int(6, 10);
                const dureeCritique = duree + rand.int(8, 15);
                const final = depart + (duree - 1) * increment;
                const critique = depart + (dureeCritique - 1) * increment;
                return { depart, increment, duree, dureeCritique, final, critique };
            },
            6: () => {
                // Ex 6: Vidange r√©servoir
                const initial = rand.multiple(3000, 8000, 500);
                const fixe = rand.multiple(150, 400, 50);
                const pourcentage = rand.int(3, 8);
                const duree = 5;
                const volFixe = initial - fixe * duree;
                const volPct = Math.round(initial * Math.pow(1 - pourcentage/100, duree));
                return { initial, fixe, pourcentage, duree, volFixe, volPct };
            },
            7: () => {
                // EXERCICE 7 : Exactement 2 situations arithm√©tiques sur 3
                // On m√©lange les types pour que ce soit al√©atoire quelle est la "mauvaise"
                const types = rand.shuffle([
                    { isArith: true, type: 'reduction' },   // R√©duction constante
                    { isArith: true, type: 'augmentation' }, // Augmentation constante
                    { isArith: false, type: 'geometrique' }  // Doublement (g√©om√©trique)
                ]);
                
                // G√©n√©ration des valeurs pour chaque situation
                const situations = types.map(t => {
                    if (t.type === 'reduction') {
                        const prix = rand.int(30, 60);
                        const reduc = rand.int(2, 5);
                        return {
                            ...t,
                            prix, reduc,
                            texte: `Un abonnement √† une salle de sport co√ªte ${prix} ‚Ç¨ le premier mois. Chaque mois suivant, le prix diminue de ${reduc} ‚Ç¨ par rapport au mois pr√©c√©dent, jusqu'√† un prix plancher.`,
                            conclusion: `Oui, c'est une suite arithm√©tique de raison r = -${reduc} (d√©croissante).`,
                            relation: `u_{n+1} = u_n - ${reduc}`
                        };
                    } else if (t.type === 'augmentation') {
                        const cout = rand.multiple(100, 300, 50);
                        const aug = rand.multiple(15, 40, 5);
                        return {
                            ...t,
                            cout, aug,
                            texte: `Pour creuser un puits, un foreur demande ${cout} ‚Ç¨ pour le premier m√®tre creus√©. Pour chaque m√®tre suppl√©mentaire, le co√ªt augmente de ${aug} ‚Ç¨ par rapport au co√ªt du m√®tre pr√©c√©dent.`,
                            conclusion: `Oui, c'est une suite arithm√©tique de raison r = ${aug} (croissante).`,
                            relation: `c_{n+1} = c_n + ${aug}`
                        };
                    } else {
                        // G√©om√©trique
                        const init = rand.int(50, 150);
                        return {
                            ...t,
                            init,
                            texte: `Une population de bact√©ries double toutes les heures dans un milieu de culture. On rel√®ve ${init} bact√©ries au d√©part.`,
                            conclusion: `Non, ce n'est pas une suite arithm√©tique. C'est une suite g√©om√©trique de raison q = 2.`,
                            relation: `v_{n+1} = 2 \\times v_n`
                        };
                    }
                });

                return { situations };
            },
            8: () => {
                // Ex 8: Argent de poche
                const initial = rand.multiple(20, 100, 5);
                const mensuel = rand.multiple(10, 30, 5);
                const mois = 4;
                const final = initial + mensuel * mois;
                return { initial, mensuel, mois, final };
            },
            9: () => {
                // Ex 9: Photocopieuse
                const initial = rand.multiple(300, 800, 50);
                const increment = rand.multiple(30, 100, 10);
                const max = rand.multiple(5000, 15000, 1000);
                const limite = Math.floor((max - initial) / increment);
                return { initial, increment, max, limite };
            },
            10: () => {
                // Ex 10: Empilement cubes
                const debut = rand.int(12, 20);
                const raison = -rand.int(1, 3);
                const rangee6 = debut + 5 * raison;
                const limite = Math.floor(-debut / raison) + 1;
                const rangee10 = debut + 9 * raison;
                return { debut, raison: Math.abs(raison), rangee6, limite, rangee10 };
            },
            11: () => {
                // Ex 11: D√©termination param√®tres
                const r = rand.multiple(10, 50, 5);
                const u0 = rand.multiple(20, 100, 10);
                const idx1 = rand.int(3, 6);
                const idx2 = idx1 + rand.int(3, 6);
                const uIdx1 = u0 + idx1 * r;
                const uIdx2 = u0 + idx2 * r;
                const idx3 = idx2 + rand.int(2, 4);
                const uIdx3 = u0 + idx3 * r;
                return { r, u0, idx1, idx2, uIdx1, uIdx2, idx3, uIdx3 };
            },
            12: () => {
                // Ex 12: Graphique avec 3 cas
                // 50% align√©s, 25% presque align√©s, 25% non align√©s
                const randVal = Math.random();
                let type;
                if (randVal < 0.5) {
                    type = 'aligned'; // 50%
                } else if (randVal < 0.75) {
                    type = 'almost'; // 25%
                } else {
                    type = 'not_aligned'; // 25%
                }
                
                const h0 = rand.int(3, 10);
                const r = rand.int(3, 8);
                const maxWeeks = 5;
                const targetWeek = 8;
                
                // Calcul des hauteurs selon le type
                const heights = [];
                const labels = ['A', 'B', 'C', 'D', 'E', 'F'];
                
                for (let i = 0; i <= 5; i++) {
                    let h;
                    if (type === 'aligned') {
                        // Parfaitement align√©s
                        h = h0 + i * r;
                    } else if (type === 'almost') {
                        // Presque align√©s (petites erreurs al√©atoires)
                        const error = rand.choice([-2, -1, 0, 0, 0, 1, 2]);
                        h = h0 + i * r + error;
                        // S'assurer que h reste positif
                        h = Math.max(2, h);
                    } else {
                        // Non align√©s (croissance qui acc√©l√®re ou ralentit)
                        if (i === 0) {
                            h = h0;
                        } else if (i === 1) {
                            h = h0 + r + rand.int(2, 4); // Croissance plus forte
                        } else if (i === 2) {
                            h = h0 + 2*r + rand.int(4, 7);
                        } else if (i === 3) {
                            h = h0 + 3*r + rand.int(1, 3); // Ralentissement
                        } else if (i === 4) {
                            h = h0 + 4*r + rand.int(5, 9); // Re-acc√©l√©ration
                        } else {
                            h = h0 + 5*r + rand.int(2, 5);
                        }
                    }
                    heights.push({
                        week: i,
                        height: h,
                        label: labels[i],
                        x: 50 + i * 80,
                        y: 250 - (h * 30) // Echelle : 1 unit√© = 30px, base √† 250
                    });
                }
                
                // Calculer les diff√©rences entre semaines cons√©cutives
                const diffs = [];
                for (let i = 0; i < heights.length - 1; i++) {
                    diffs.push(heights[i+1].height - heights[i].height);
                }
                
                const finalHeight = type === 'aligned' ? h0 + targetWeek * r : 
                                   type === 'almost' ? h0 + targetWeek * r : 
                                   null; // Non calculable pour non align√©s
                
                return { 
                    type, 
                    h0, 
                    r, 
                    maxWeeks: 5, 
                    targetWeek: 8, 
                    heights, 
                    diffs, 
                    finalHeight 
                };
            }
        };

        // Templates des exercices (fonctions qui retournent le HTML avec les valeurs)
        const exerciseTemplates = {
            1: (v) => ({
                category: "Identification du mod√®le",
                title: "√âvolution d'une population de bact√©ries",
                content: `
                    <p>Un biologiste observe une population de bact√©ries. Il rel√®ve les effectifs suivants (en milliers) :</p>
                    <div class="math-block">
                        \\begin{array}{|c|c|c|c|c|}
                        \\hline
                        \\text{Heure } n & 0 & 1 & 2 & 3 \\\\
                        \\hline
                        \\text{Population} & ${v.u0} & ${v.u1} & ${v.u2} & ${v.u3} \\\\
                        \\hline
                        \\end{array}
                    </div>
                    <p><strong>Question :</strong> Cette √©volution peut-elle √™tre mod√©lis√©e par une suite arithm√©tique ?</p>
                    <p>Justifier rigoureusement votre r√©ponse en analysant les variations entre termes cons√©cutifs.</p>
                    <p style="margin-top: 30px; color: var(--secondary); font-size: 1.1rem;">üí° <em>Pour vous aider : calculez les diff√©rences entre termes successifs.</em></p>
                `,
                solution: v.isArithmetic ? `
                    <div class="solution-step">
                        <h4>Analyse des diff√©rences</h4>
                        <p>V√©rifions si les accroissements sont constants :</p>
                        <ul>
                            <li>Entre \\(n=0\\) et \\(n=1\\) : \\( ${v.u1} - ${v.u0} = ${v.diff1} \\)</li>
                            <li>Entre \\(n=1\\) et \\(n=2\\) : \\( ${v.u2} - ${v.u1} = ${v.diff2} \\)</li>
                            <li>Entre \\(n=2\\) et \\(n=3\\) : \\( ${v.u3} - ${v.u2} = ${v.u3 - v.u2} \\)</li>
                        </ul>
                    </div>
                    <div class="solution-step">
                        <h4>Conclusion</h4>
                        <p>Les diff√©rences sont √©gales (constantes et √©gales √† ${v.r}).</p>
                        <p><strong>Oui, c'est une suite arithm√©tique</strong> de raison \\(r = ${v.r}\\).</p>
                        <p>La croissance est lin√©aire (ajout de ${v.r} milliers de bact√©ries par heure).</p>
                    </div>
                ` : `
                    <div class="solution-step">
                        <h4>Analyse des diff√©rences</h4>
                        <p>V√©rifions si les accroissements sont constants :</p>
                        <ul>
                            <li>Entre \\(n=0\\) et \\(n=1\\) : \\( ${v.u1} - ${v.u0} = ${v.diff1} \\)</li>
                            <li>Entre \\(n=1\\) et \\(n=2\\) : \\( ${v.u2} - ${v.u1} = ${v.diff2} \\)</li>
                        </ul>
                    </div>
                    <div class="solution-step">
                        <h4>Conclusion</h4>
                        <p>Les diff√©rences ne sont pas √©gales (\\(${v.diff1} \\neq ${v.diff2}\\)).</p>
                        <p><strong>Ce n'est pas une suite arithm√©tique.</strong></p>
                        <p>Il s'agit en r√©alit√© d'une <em>suite g√©om√©trique</em> de raison \\(q = ${v.q}\\) (croissance exponentielle typique des populations bact√©riennes).</p>
                    </div>
                `
            }),
            2: (v) => ({
                category: "Mod√©lisation d√©gressive",
                title: "D√©pr√©ciation lin√©aire d'une machine",
                content: `
                    <p>Une entreprise ach√®te une machine pour <strong>${v.initial.toLocaleString()} ‚Ç¨</strong>.</p>
                    <p>Elle applique une d√©pr√©ciation lin√©aire sur ${v.duree} ans : chaque ann√©e, la machine perd <strong>${v.depreciation.toLocaleString()} ‚Ç¨</strong> de valeur.</p>
                    <div class="math-block">
                        \\(\\text{Soit } v_n \\text{ la valeur au bout de } n \\text{ ann√©es}\\)
                    </div>
                    <p><strong>Questions :</strong></p>
                    <ol>
                        <li>Exprimer \\(v_{n+1}\\) en fonction de \\(v_n\\) (relation de r√©currence)</li>
                        <li>Pr√©ciser la nature de la suite, son premier terme et sa raison</li>
                        <li>Quel est le sens de variation ? Interpr√©ter concr√®tement</li>
                        <li>Quelle sera la valeur apr√®s ${v.annees} ans ?</li>
                    </ol>
                `,
                solution: `
                    <div class="solution-step">
                        <h4>1. Relation de r√©currence</h4>
                        <p>Chaque ann√©e, on soustrait ${v.depreciation.toLocaleString()} ‚Ç¨ :</p>
                        <p>\\[v_{n+1} = v_n - ${v.depreciation.toLocaleString()} \\quad \\text{avec} \\quad v_0 = ${v.initial.toLocaleString()}\\]</p>
                    </div>
                    <div class="solution-step">
                        <h4>2. Nature de la suite</h4>
                        <p>C'est une <strong>suite arithm√©tique</strong> :</p>
                        <ul>
                            <li>Premier terme : \\(v_0 = ${v.initial.toLocaleString()}\\) ‚Ç¨</li>
                            <li>Raison : \\(r = -${v.depreciation.toLocaleString()}\\)</li>
                        </ul>
                    </div>
                    <div class="solution-step">
                        <h4>3. Sens de variation</h4>
                        <p>La raison \\(r = -${v.depreciation.toLocaleString()} < 0\\), donc la suite est <strong>strictement d√©croissante</strong>.</p>
                        <p><em>Interpr√©tation :</em> La valeur de la machine diminue r√©guli√®rement de ${v.depreciation.toLocaleString()} ‚Ç¨ par an jusqu'√† atteindre 0 ‚Ç¨ au bout de ${v.duree} ans.</p>
                    </div>
                    <div class="solution-step">
                        <h4>4. Calcul apr√®s ${v.annees} ans</h4>
                        <p>\\(v_{${v.annees}} = ${v.initial.toLocaleString()} - ${v.annees} \\times ${v.depreciation.toLocaleString()} = \\mathbf{${(v.initial - v.depreciation * v.annees).toLocaleString()}}\\) ‚Ç¨</p>
                    </div>
                `
            }),
            3: (v) => ({
                category: "Application financi√®re",
                title: "√âchelonnement de dette",
                content: `
                    <p>Une association doit rembourser une dette de <strong>${v.initial.toLocaleString()} ‚Ç¨</strong>.</p>
                    <p>Chaque mois, elle rembourse <strong>${v.mensualite} ‚Ç¨</strong> d'amortissement du capital (hors int√©r√™ts).</p>
                    <div class="math-block">
                        \\(d_n = \\text{dette restante apr√®s } n \\text{ mois}\\)
                    </div>
                    <p><strong>Questions :</strong></p>
                    <ol>
                        <li>Montrer que \\((d_n)\\) est arithm√©tique en justifiant par la relation de r√©currence \\(d_{n+1} = d_n + r\\)</li>
                        <li>Pr√©ciser \\(d_0\\) et la raison \\(r\\)</li>
                        <li>Calculer la dette restante apr√®s ${v.mois1} mois, puis ${v.mois2} mois</li>
                        <li>Au bout de combien de mois la dette est-elle totalement rembours√©e ?</li>
                    </ol>
                `,
                solution: `
                    <div class="solution-step">
                        <h4>1. Nature de la suite</h4>
                        <p>Relation : \\(d_{n+1} = d_n - ${v.mensualite}\\) avec \\(d_0 = ${v.initial.toLocaleString()}\\)</p>
                        <p>Forme \\(u_{n+1} = u_n + r\\) avec \\(r = -${v.mensualite}\\).</p>
                        <p><strong>C'est une suite arithm√©tique</strong> de raison n√©gative (dette qui diminue).</p>
                    </div>
                    <div class="solution-step">
                        <h4>2. Caract√©ristiques</h4>
                        <ul>
                            <li>\\(d_0 = ${v.initial.toLocaleString()}\\) ‚Ç¨ (dette initiale)</li>
                            <li>\\(r = -${v.mensualite}\\) (remboursement mensuel)</li>
                        </ul>
                    </div>
                    <div class="solution-step">
                        <h4>3. Calculs par it√©ration</h4>
                        <p>Apr√®s ${v.mois1} mois : \\(d_{${v.mois1}} = ${v.initial.toLocaleString()} - ${v.mois1} \\times ${v.mensualite} = ${v.initial.toLocaleString()} - ${v.mois1 * v.mensualite} = \\mathbf{${(v.initial - v.mois1 * v.mensualite).toLocaleString()}}\\) ‚Ç¨</p>
                        <p>Apr√®s ${v.mois2} mois : \\(d_{${v.mois2}} = ${v.initial.toLocaleString()} - ${v.mois2} \\times ${v.mensualite} = ${v.initial.toLocaleString()} - ${v.mois2 * v.mensualite} = \\mathbf{${(v.initial - v.mois2 * v.mensualite).toLocaleString()}}\\) ‚Ç¨</p>
                    </div>
                    <div class="solution-step">
                        <h4>4. Remboursement total</h4>
                        <p>On r√©sout : \\(${v.initial.toLocaleString()} - ${v.mensualite}n \\leq 0\\)</p>
                        <p>\\(${v.mensualite}n \\geq ${v.initial.toLocaleString()}\\) donc \\(n \\geq \\frac{${v.initial.toLocaleString()}}{${v.mensualite}} = ${v.moisTotal}\\)</p>
                        <p>La dette sera rembours√©e au bout de <strong>${v.moisTotal} mois (${(v.moisTotal/12).toFixed(1)} ans)</strong>.</p>
                    </div>
                `
            }),
            4: (v) => ({
                category: "Ph√©nom√®ne physique",
                title: "Temp√©rature et altitude",
                content: `
                    <p>En m√©trologie, on consid√®re que la temp√©rature de l'air diminue de <strong>${v.gradient}¬∞C</strong> tous les 100 m√®tres d'altitude (troposph√®re).</p>
                    <p>Au niveau de la mer (altitude 0 m), la temp√©rature est de <strong>${v.temp0}¬∞C</strong>.</p>
                    <div class="math-block">
                        \\(t_n = \\text{temp√©rature (¬∞C) √† l'altitude } 100n \\text{ m√®tres}\\)
                    </div>
                    <p><strong>Questions :</strong></p>
                    <ol>
                        <li>Justifier que \\((t_n)\\) est arithm√©tique en √©crivant la relation de r√©currence</li>
                        <li>Pr√©ciser le premier terme et la raison. Quel est leur signe ?</li>
                        <li>Calculer \\(t_{${v.alt1}}\\) et \\(t_{${v.alt2}}\\). Interpr√©ter.</li>
                        <li>√âtudier le sens de variation et sa coh√©rence physique</li>
                    </ol>
                `,
                solution: `
                    <div class="solution-step">
                        <h4>1. Mod√©lisation</h4>
                        <p>\\(t_{n+1} = t_n - ${v.gradient}\\) avec \\(t_0 = ${v.temp0}\\)</p>
                        <p>C'est bien de la forme \\(u_{n+1} = u_n + r\\).</p>
                    </div>
                    <div class="solution-step">
                        <h4>2. Caract√©ristiques</h4>
                        <p>Suite arithm√©tique :</p>
                        <ul>
                            <li>Premier terme : \\(t_0 = ${v.temp0}\\) (positif)</li>
                            <li>Raison : \\(r = -${v.gradient}\\) (n√©gatif)</li>
                        </ul>
                    </div>
                    <div class="solution-step">
                        <h4>3. Calculs</h4>
                        <p>\\(t_{${v.alt1}} = ${v.temp0} - ${v.alt1} \\times ${v.gradient} = ${v.temp0} - ${(v.alt1 * v.gradient).toFixed(1).replace('.0', '')} = \\mathbf{${(v.temp0 - v.alt1 * v.gradient).toFixed(1).replace('.0', '')}}\\)¬∞C (√† ${v.alt1 * 100} m d'altitude)</p>
                        <p>\\(t_{${v.alt2}} = ${v.temp0} - ${v.alt2} \\times ${v.gradient} = ${v.temp0} - ${(v.alt2 * v.gradient).toFixed(1).replace('.0', '')} = \\mathbf{${(v.temp0 - v.alt2 * v.gradient).toFixed(1).replace('.0', '')}}\\)¬∞C (√† ${v.alt2 * 100} m d'altitude)</p>
                    </div>
                    <div class="solution-step">
                        <h4>4. Analyse</h4>
                        <p>\\(r = -${v.gradient} < 0\\) : suite <strong>strictement d√©croissante</strong>.</p>
                        <p>C'est coh√©rent physiquement : plus on monte en altitude, plus il fait froid (gradient thermique atmosph√©rique).</p>
                    </div>
                `
            }),
            5: (v) => ({
                category: "Probl√®me ouvert critique",
                title: "Training sportif et limites du mod√®le",
                content: `
                    <p>Un athl√®te pr√©pare un marathon. Son programme sur ${v.duree} semaines pr√©voit d'augmenter sa distance hebdomadaire de <strong>${v.increment} km</strong> chaque semaine.</p>
                    <p>La premi√®re semaine, il court <strong>${v.depart} km</strong>.</p>
                    <div class="math-block">
                        \\(a_n = \\text{distance (km) parcourue la semaine } n\\)
                    </div>
                    <p><strong>Probl√®me :</strong></p>
                    <ol>
                        <li>Mod√©liser par une suite arithm√©tique : donner \\(a_1\\) et la raison \\(r\\)</li>
                        <li>Calculer la distance pr√©vue pour la ${v.duree}√®me semaine (\\(a_${v.duree}\\))</li>
                        <li>√âtudier le sens de variation de \\((a_n)\\)</li>
                        <li><span style="color: #e11d48; font-weight: bold;">Critique :</span> Pourquoi ce mod√®le arithm√©tique n'est-il pas r√©aliste sur le long terme ? Que se passerait-il au bout de ${v.dureeCritique} semaines ?</li>
                    </ol>
                `,
                solution: `
                    <div class="solution-step">
                        <h4>1. Mod√©lisation</h4>
                        <p>\\(a_{n+1} = a_n + ${v.increment}\\) avec \\(a_1 = ${v.depart}\\)</p>
                        <p>Si on indexe √† partir de 0 : \\(a_0 = ${v.depart}\\) et \\(a_n = a_0 + ${v.increment}n\\)</p>
                        <p>Suite arithm√©tique de raison \\(r = ${v.increment} > 0\\)</p>
                    </div>
                    <div class="solution-step">
                        <h4>2. Calcul pour la ${v.duree}√®me semaine</h4>
                        <p>\\(a_{${v.duree}} = ${v.depart} + ${v.duree - 1} \\times ${v.increment} = ${v.depart} + ${(v.duree - 1) * v.increment} = \\mathbf{${v.final}}\\) km</p>
                    </div>
                    <div class="solution-step">
                        <h4>3. Sens de variation</h4>
                        <p>\\(r = ${v.increment} > 0\\) : suite <strong>strictement croissante</strong> (progression constante).</p>
                    </div>
                    <div class="solution-step">
                        <h4>4. Critique du mod√®le</h4>
                        <p>Au bout de ${v.dureeCritique} semaines : \\(a_{${v.dureeCritique}} = ${v.depart} + ${v.dureeCritique - 1} \\times ${v.increment} = ${v.depart} + ${(v.dureeCritique - 1) * v.increment} = ${v.critique}\\) km !</p>
                        <p><strong>Limites :</strong></p>
                        <ul>
                            <li>Mod√®le lin√©aire ind√©fini dangereux pour la sant√©</li>
                            <li>Risque de blessure (surentragement, fractures de stress)</li>
                            <li>Capacit√©s physiologiques limit√©es</li>
                            <li>Un palier ou progression logarithmique serait plus r√©aliste</li>
                        </ul>
                        <p><em>Conclusion : Les suites arithm√©tiques mod√©lisent bien les ph√©nom√®nes √† court terme, mais rarement les ph√©nom√®nes biologiques sur le long terme.</em></p>
                    </div>
                `
            }),
            6: (v) => ({
                category: "Comparaison de mod√®les",
                title: "Vidange d'un r√©servoir",
                content: `
                    <p>Un r√©servoir contient <strong>${v.initial.toLocaleString()} L</strong> d'eau. On propose deux sc√©narios de vidange :</p>
                    <div class="math-block">
                        \\begin{cases}
                        \\text{Sc√©nario 1 :} & \\text{Retirer ${v.fixe} L par minute (mod√®le A)} \\\\
                        \\text{Sc√©nario 2 :} & \\text{Retirer ${v.pourcentage}% du volume restant par minute (mod√®le B)}
                        \\end{cases}
                    </div>
                    <p><strong>Analyse compar√©e :</strong></p>
                    <ol>
                        <li>Pour chaque sc√©nario, identifier si la suite, qui permet de mod√©liser la situation, est arithm√©tique et donner la relation de r√©currence \\(u_{n+1} = f(u_n)\\)</li>
                        <li>Calculer le volume apr√®s ${v.duree} minutes pour chaque sc√©nario</li>
                        <li>D√©terminer au bout de combien de temps le r√©servoir est vide (ou quasi-vide) dans chaque cas</li>
                        <li>Quel sc√©nario vide plus vite au d√©but ? Plus vite √† la fin ? Justifier.</li>
                    </ol>
                `,
                solution: `
                    <div class="solution-step">
                        <h4>1. Mod√®les math√©matiques</h4>
                        <p><strong>Sc√©nario 1 :</strong> \\(u_{n+1} = u_n - ${v.fixe}\\) avec \\(u_0 = ${v.initial.toLocaleString()}\\)</p>
                        <p>C'est une suite arithm√©tique de raison \\(r = -${v.fixe}\\).</p>
                        <br>
                        <p><strong>Sc√©nario 2 :</strong> \\(v_{n+1} = v_n - ${v.pourcentage/100}v_n = ${1-v.pourcentage/100} \\times v_n\\) avec \\(v_0 = ${v.initial.toLocaleString()}\\)</p>
                        <p>C'est une suite g√©om√©trique de raison \\(q = ${1-v.pourcentage/100}\\).</p>
                    </div>
                    <div class="solution-step">
                        <h4>2. Calculs apr√®s ${v.duree} minutes</h4>
                        <p>Sc√©nario 1 : \\(u_${v.duree} = ${v.initial.toLocaleString()} - ${v.duree} \\times ${v.fixe} = \\mathbf{${v.volFixe.toLocaleString()}}\\) L</p>
                        <p>Sc√©nario 2 : \\(v_${v.duree} = ${v.initial.toLocaleString()} \\times ${1-v.pourcentage/100}^${v.duree} \\approx \\mathbf{${v.volPct.toLocaleString()}}\\) L</p>
                        <p><em>Au bout de ${v.duree} min, le sc√©nario ${v.volFixe < v.volPct ? 1 : 2} a vid√© plus (${Math.max(v.initial-v.volFixe, v.initial-v.volPct).toLocaleString()} L vs ${Math.min(v.initial-v.volFixe, v.initial-v.volPct).toLocaleString()} L).</em></p>
                    </div>
                    <div class="solution-step">
                        <h4>3. Temps de vidange</h4>
                        <p><strong>Sc√©nario 1 :</strong> \\(${v.initial.toLocaleString()} - ${v.fixe}n = 0 \\Rightarrow n = ${Math.ceil(v.initial/v.fixe)}\\) minutes (vidange exacte et compl√®te)</p>
                        <p><strong>Sc√©nario 2 :</strong> jamais exactement 0 (asymptote), mais on peut calculer quand il reste moins d'1L...</p>
                    </div>
                    <div class="solution-step">
                        <h4>4. Analyse comparative</h4>
                        <p><strong>Au d√©but :</strong> Sc√©nario 2 retire ${v.pourcentage}% de ${v.initial.toLocaleString()} = ${Math.round(v.initial*v.pourcentage/100)} L ${Math.round(v.initial*v.pourcentage/100) > v.fixe ? '>' : '<'} ${v.fixe} L</p>
                        <p><strong>√Ä la fin :</strong> Sc√©nario 1 conserve son d√©bit constant (${v.fixe} L/min) alors que le sc√©nario 2 ralentit drastiquement (pourcentage d'un volume faible).</p>
                    </div>
                `
            }),
            7: (v) => {
                // Exercice 7 avec r√©partition al√©atoire 2 arithm√©tiques / 1 non
                const [sitA, sitB, sitC] = v.situations;
                
                return {
                    category: "Identification du mod√®le",
                    title: "Mod√©lisation possible ou non ?",
                    content: `
                        <p>Dans chacune des situations suivantes, d√©terminez si la situation peut √™tre mod√©lis√©e par une suite arithm√©tique. Justifiez votre r√©ponse.</p>
                        
                        <div class="math-block">
                            <strong>Situation A :</strong> ${sitA.texte} On note \\(u_n\\) le terme au rang \\(n\\).
                        </div>
                        
                        <div class="math-block">
                            <strong>Situation B :</strong> ${sitB.texte} On note \\(v_n\\) le terme au rang \\(n\\).
                        </div>
                        
                        <div class="math-block">
                            <strong>Situation C :</strong> ${sitC.texte} On note \\(w_n\\) le terme au rang \\(n\\).
                        </div>
                    `,
                    solution: `
                        <div class="solution-step">
                            <h4>Situation A</h4>
                            <p>Relation : $${sitA.relation}$</p>
                            <p>${sitA.conclusion}</p>
                        </div>
                        <div class="solution-step">
                            <h4>Situation B</h4>
                            <p>Relation : $${sitB.relation}$</p>
                            <p>${sitB.conclusion}</p>
                        </div>
                        <div class="solution-step">
                            <h4>Situation C</h4>
                            <p>Relation : $${sitC.relation}$</p>
                            <p>${sitC.conclusion}</p>
                        </div>
                        <div class="solution-step">
                            <h4>Bilan</h4>
                            <p>${v.situations.filter(s => s.isArith).length} situation(s) sur 3 peu(vent) √™tre mod√©lis√©e(s) par une suite arithm√©tique.</p>
                            <p>‚ö†Ô∏è <strong>Attention :</strong> Il est important de v√©rifier syst√©matiquement si les accroissements sont constants avant de conclure !</p>
                        </div>
                    `
                };
            },
            8: (v) => ({
                category: "Calcul de termes",
                title: "L'argent de poche de L√©o",
                content: `
                    <p>L√©o d√©cide d'√©conomiser pour s'acheter une console de jeux. Il dispose initialement de <strong>${v.initial} ‚Ç¨</strong> dans sa tirelire (mois 0).</p>
                    <p>Ses parents d√©cident de lui donner <strong>${v.mensuel} ‚Ç¨</strong> d'argent de poche chaque mois, qu'il ajoute int√©gralement √† sa tirelire.</p>
                    <div class="math-block">
                        \\(u_n = \\text{montant total dans la tirelire au bout de } n \\text{ mois}\\)
                    </div>
                    <p><strong>Questions :</strong></p>
                    <ol>
                        <li>Pr√©cisez le premier terme \\(u_0\\) de la suite.</li>
                        <li>Exprimez le montant \\(u_{n+1}\\) en fonction du montant \\(u_n\\) du mois pr√©c√©dent. Quelle est la nature de la suite \\((u_n)\\) ? Pr√©cisez sa raison.</li>
                        <li>D√©terminez le sens de variation de la suite \\((u_n)\\). Justifiez.</li>
                        <li>Calculez, pas √† pas, le montant dont disposera L√©o au bout de ${v.mois} mois (\\(u_${v.mois}\\)).</li>
                    </ol>
                `,
                solution: `
                    <div class="solution-step">
                        <h4>1. Premier terme</h4>
                        <p>\\(u_0 = ${v.initial}\\) ‚Ç¨ (montant initial)</p>
                    </div>
                    <div class="solution-step">
                        <h4>2. Nature de la suite</h4>
                        <p>Relation de r√©currence : \\[u_{n+1} = u_n + ${v.mensuel}\\]</p>
                        <p><strong>C'est une suite arithm√©tique</strong> de raison \\(r = ${v.mensuel}\\).</p>
                        <p>Chaque mois, on ajoute la m√™me somme (${v.mensuel} ‚Ç¨).</p>
                    </div>
                    <div class="solution-step">
                        <h4>3. Sens de variation</h4>
                        <p>La raison \\(r = ${v.mensuel} > 0\\), donc la suite est <strong>strictement croissante</strong>.</p>
                        <p>L'√©pargne de L√©o augmente r√©guli√®rement chaque mois.</p>
                    </div>
                    <div class="solution-step">
                        <h4>4. Calcul pas √† pas jusqu'√† \\(u_${v.mois}\\)</h4>
                        <ul>
                            <li>\\(u_0 = ${v.initial}\\) ‚Ç¨</li>
                            <li>\\(u_1 = ${v.initial} + ${v.mensuel} = ${v.initial + v.mensuel}\\) ‚Ç¨</li>
                            <li>\\(u_2 = ${v.initial + v.mensuel} + ${v.mensuel} = ${v.initial + 2*v.mensuel}\\) ‚Ç¨</li>
                            <li>\\(u_3 = ${v.initial + 2*v.mensuel} + ${v.mensuel} = ${v.initial + 3*v.mensuel}\\) ‚Ç¨</li>
                            <li>\\(u_4 = ${v.initial + 3*v.mensuel} + ${v.mensuel} = \\mathbf{${v.final}}\\) ‚Ç¨</li>
                        </ul>
                        <p>Au bout de ${v.mois} mois, L√©o disposera de ${v.final} ‚Ç¨.</p>
                    </div>
                `
            }),
            9: (v) => ({
                category: "Comparaison et limites",
                title: "Location de mat√©riel",
                content: `
                    <p>Une entreprise propose deux tarifs pour la location d'une photocopieuse. On s'int√©resse √† l'√©volution du nombre de copies mensuelles.</p>
                    <p>Un client imprime <strong>${v.initial} copies</strong> le premier mois, puis augmente sa consommation de <strong>${v.increment} copies</strong> chaque mois suivant.</p>
                    <div class="math-block">
                        \\((c_n) = \\text{nombre de copies imprim√©es le mois } n \\quad \\text{avec} \\quad c_0 = ${v.initial}\\)
                    </div>
                    <p><strong>Questions :</strong></p>
                    <ol>
                        <li>Justifiez que la suite \\((c_n)\\) mod√©lisant le nombre de copies est arithm√©tique. Donnez sa raison.</li>
                        <li>Calculez le nombre de copies pr√©vues pour le mois \\(n=3\\).</li>
                        <li><em>Question ouverte :</em> Si la capacit√© maximale de la photocopieuse est de ${v.max.toLocaleString()} copies par mois, la mod√©lisation par cette suite arithm√©tique est-elle valable ind√©finiment ? Expliquez.</li>
                    </ol>
                `,
                solution: `
                    <div class="solution-step">
                        <h4>1. Nature de la suite</h4>
                        <p>Chaque mois, on ajoute ${v.increment} copies : \\[c_{n+1} = c_n + ${v.increment}\\]</p>
                        <p>Avec \\(c_0 = ${v.initial}\\).</p>
                        <p><strong>C'est une suite arithm√©tique</strong> de raison \\(r = ${v.increment}\\) (strictement croissante).</p>
                    </div>
                    <div class="solution-step">
                        <h4>2. Calcul pour le mois \\(n=3\\)</h4>
                        <ul>
                            <li>\\(c_0 = ${v.initial}\\)</li>
                            <li>\\(c_1 = ${v.initial} + ${v.increment} = ${v.initial + v.increment}\\)</li>
                            <li>\\(c_2 = ${v.initial + v.increment} + ${v.increment} = ${v.initial + 2*v.increment}\\)</li>
                            <li>\\(c_3 = ${v.initial + 2*v.increment} + ${v.increment} = \\mathbf{${v.initial + 3*v.increment}}\\) copies</li>
                        </ul>
                    </div>
                    <div class="solution-step">
                        <h4>3. Validit√© du mod√®le</h4>
                        <p><strong>Non, la mod√©lisation n'est pas valable ind√©finiment.</strong></p>
                        <p>On cherche \\(n\\) tel que \\(c_n > ${v.max.toLocaleString()}\\) :</p>
                        <p>\\(${v.initial} + ${v.increment}n > ${v.max.toLocaleString()}\\)</p>
                        <p>\\(${v.increment}n > ${v.max - v.initial}\\)</p>
                        <p>\\(n > ${Math.floor((v.max - v.initial)/v.increment)}\\)</p>
                        <p>Au bout de ${v.limite} mois (environ ${Math.floor(v.limite/12)} ans), la suite pr√©voit plus de ${v.max.toLocaleString()} copies, ce qui d√©passe la capacit√© maximale. Le mod√®le arithm√©tique n'est valable que tant que \\(c_n \\leq ${v.max.toLocaleString()}\\).</p>
                    </div>
                `
            }),
            10: (v) => ({
                category: "Probl√®me ouvert",
                title: "Empilement de cubes",
                content: `
                    <p>Un enfant construit une tour avec des cubes selon une logique arithm√©tique :</p>
                    <ul>
                        <li>Rang√©e 1 (bas) : <strong>${v.debut} cubes</strong></li>
                        <li>Rang√©e 2 : <strong>${v.debut - v.raison} cubes</strong></li>
                        <li>Rang√©e 3 : <strong>${v.debut - 2*v.raison} cubes</strong></li>
                        <li>Et ainsi de suite...</li>
                    </ul>
                    <div class="math-block">
                        \\((u_n) = \\text{nombre de cubes sur la } n\\text{-√®me rang√©e}\\)
                    </div>
                    <p><strong>Probl√®me :</strong></p>
                    <ol>
                        <li>Mod√©lisez cette situation √† l'aide d'une suite \\((u_n)\\) en pr√©cisant ce que repr√©sente \\(n\\) et \\(u_n\\), et donnez la relation de r√©currence liant \\(u_{n+1}\\) et \\(u_n\\).</li>
                        <li>Combien de cubes contiendra la 6√®me rang√©e ?</li>
                        <li>L'enfant pourra-t-il construire une 10√®me rang√©e selon cette r√®gle ? Justifiez votre r√©ponse sans n√©cessairement faire tous les calculs interm√©diaires, mais en utilisant le sens de variation de la suite.</li>
                    </ol>
                `,
                solution: `
                    <div class="solution-step">
                        <h4>1. Mod√©lisation</h4>
                        <p>\\(n\\) repr√©sente le num√©ro de la rang√©e (en partant du bas).</p>
                        <p>\\(u_n\\) repr√©sente le nombre de cubes sur la \\(n\\)-√®me rang√©e.</p>
                        <p>Relation de r√©currence : \\[u_{n+1} = u_n - ${v.raison}\\]</p>
                        <p>Avec \\(u_1 = ${v.debut}\\) (ou \\(u_0 = ${v.debut}\\) si on indexe √† partir de 0).</p>
                        <p><strong>C'est une suite arithm√©tique</strong> de raison \\(r = -${v.raison}\\).</p>
                    </div>
                    <div class="solution-step">
                        <h4>2. Calcul pour la 6√®me rang√©e</h4>
                        <p>En partant de \\(u_1 = ${v.debut}\\) :</p>
                        <ul>
                            <li>\\(u_2 = ${v.debut - v.raison}\\)</li>
                            <li>\\(u_3 = ${v.debut - 2*v.raison}\\)</li>
                            <li>\\(u_4 = ${v.debut - 3*v.raison}\\)</li>
                            <li>\\(u_5 = ${v.debut - 4*v.raison}\\)</li>
                            <li>\\(u_6 = \\mathbf{${v.rangee6}}\\) cubes</li>
                        </ul>
                        <p>Ou directement : \\(u_6 = ${v.debut} + 5 \\times (-${v.raison}) = ${v.rangee6}\\)</p>
                    </div>
                    <div class="solution-step">
                        <h4>3. Possibilit√© de la 10√®me rang√©e</h4>
                        <p>La raison \\(r = -${v.raison} < 0\\), donc la suite est <strong>strictement d√©croissante</strong>.</p>
                        <p>Calcul pour la 10√®me rang√©e : \\(u_{10} = ${v.debut} + 9 \\times (-${v.raison}) = ${v.debut} - ${9*v.raison} = ${v.rangee10}\\)</p>
                        <p><strong>Conclusion :</strong> Il est ${v.rangee10 > 0 ? 'possible' : 'impossible'} de construire une 10√®me rang√©e${v.rangee10 <= 0 ? ' car cela n√©cessiterait un nombre n√©gatif ou nul de cubes' : ''}.</p>
                        ${v.limite < 10 ? `<p>En r√©alit√©, l'enfant s'arr√™tera avant : d√®s que \\(u_n \\leq 0\\), on ne peut plus poser de cubes. La derni√®re rang√©e possible est la ${v.limite}√®me (${v.debut - (v.limite-1)*v.raison} cube${v.debut - (v.limite-1)*v.raison > 1 ? 's' : ''}).</p>` : ''}
                    </div>
                `
            }),
            11: (v) => ({
                category: "D√©termination des param√®tres",
                title: "Trouver la raison et le premier terme",
                content: `
                    <p>On sait que le nombre de clients mensuels d'une salle de sport, not√© \\(u_n\\) au mois \\(n\\), √©volue selon une suite arithm√©tique.</p>
                    <p>On rel√®ve les donn√©es suivantes issues des statistiques :</p>
                    <div class="math-block">
                        \\begin{cases}
                        u_{${v.idx1}} = ${v.uIdx1} \\text{ clients} \\\\
                        u_{${v.idx2}} = ${v.uIdx2} \\text{ clients}
                        \\end{cases}
                    </div>
                    <p><strong>Probl√®me :</strong></p>
                    <ol>
                        <li>D√©terminer la raison \\(r\\) de cette suite.</li>
                        <li>Calculer \\(u_0\\) (le nombre de clients au mois 0/initial).</li>
                        <li>Exprimer la relation de r√©currence compl√®te de la suite.</li>
                        <li>Combien de clients y aura-t-il au mois ${v.idx3} ?</li>
                    </ol>
                `,
                solution: `
                    <div class="solution-step">
                        <h4>1. Calcul de la raison r</h4>
                        <p>On utilise la propri√©t√© des suites arithm√©tiques : \\(u_p = u_q + (p-q)r\\)</p>
                        <p>Avec \\(p = ${v.idx2}\\) et \\(q = ${v.idx1}\\) :</p>
                        <p>\\[u_${v.idx2} = u_${v.idx1} + (${v.idx2}-${v.idx1})r\\]</p>
                        <p>\\[${v.uIdx2} = ${v.uIdx1} + ${v.idx2-v.idx1}r\\]</p>
                        <p>\\[${v.idx2-v.idx1}r = ${v.uIdx2 - v.uIdx1}\\]</p>
                        <p>\\[\\mathbf{r = ${v.r}}\\]</p>
                        <p>La raison est ${v.r} (augmentation de ${v.r} clients par mois).</p>
                    </div>
                    <div class="solution-step">
                        <h4>2. Calcul de u_0</h4>
                        <p>On utilise \\(u_${v.idx1} = u_0 + ${v.idx1}r\\) :</p>
                        <p>\\[${v.uIdx1} = u_0 + ${v.idx1} \\times ${v.r}\\]</p>
                        <p>\\[${v.uIdx1} = u_0 + ${v.idx1 * v.r}\\]</p>
                        <p>\\[\\mathbf{u_0 = ${v.u0}}\\]</p>
                        <p>Il y avait ${v.u0} clients au d√©part (mois 0).</p>
                    </div>
                    <div class="solution-step">
                        <h4>3. Relation de r√©currence</h4>
                        <p>\\[u_{n+1} = u_n + ${v.r} \\quad \\text{avec} \\quad u_0 = ${v.u0}\\]</p>
                        <p>Ou si on indexe √† partir de 1 : \\(u_{n+1} = u_n + ${v.r}\\) avec \\(u_1 = ${v.u0 + v.r}\\).</p>
                    </div>
                    <div class="solution-step">
                        <h4>4. Nombre de clients au mois ${v.idx3}</h4>
                        <p>\\(u_${v.idx3} = u_${v.idx2} + (${v.idx3}-${v.idx2})r = ${v.uIdx2} + ${v.idx3-v.idx2} \\times ${v.r} = ${v.uIdx2} + ${(v.idx3-v.idx2)*v.r} = \\mathbf{${v.uIdx3}}\\) clients</p>
                        <p>Ou avec \\(u_0\\) : \\(u_${v.idx3} = u_0 + ${v.idx3}r = ${v.u0} + ${v.idx3 * v.r} = ${v.uIdx3}\\) clients.</p>
                    </div>
                `
            }),
            12: (v) => {
                // G√©n√©ration des points SVG dynamiquement
                const pointsSVG = v.heights.map(h => `
                    <circle cx="${h.x}" cy="${h.y}" r="6" fill="#2563eb" stroke="white" stroke-width="2"/>
                    <text x="${h.x}" y="${h.y - 15}" text-anchor="middle" font-size="11" fill="#2563eb">${h.label}(${h.week}; ${h.height})</text>
                `).join('');
                
                // D√©termination des ticks Y bas√©s sur les valeurs max
                const maxVal = Math.max(...v.heights.map(h => h.height));
                const yMax = Math.ceil(maxVal / 5) * 5 + 5; // Arrondir au multiple de 5 sup√©rieur + marge
                
                const getYPos = (val) => 250 - (val / yMax) * 200; // 200 = hauteur utile du graphique
                
                // G√©n√©rer les ticks Y
                let ticksY = '';
                for (let i = 0; i <= 4; i++) {
                    const val = Math.round((yMax / 4) * i);
                    const yPos = getYPos(val);
                    ticksY += `
                        <line x1="45" y1="${yPos}" x2="50" y2="${yPos}" stroke="#1e293b" stroke-width="2"/>
                        <text x="40" y="${yPos + 5}" text-anchor="end" font-size="12">${val}</text>
                    `;
                }
                
                // Recalculer les positions Y des points avec la bonne √©chelle
                const pointsWithCorrectY = v.heights.map(h => ({
                    ...h,
                    y: getYPos(h.height)
                }));
                
                const pointsSVGCorrect = pointsWithCorrectY.map(h => `
                    <circle cx="${h.x}" cy="${h.y}" r="6" fill="#2563eb" stroke="white" stroke-width="2"/>
                    <text x="${h.x}" y="${h.y - 15}" text-anchor="middle" font-size="11" fill="#2563eb">${h.label}(${h.week}; ${h.height})</text>
                `).join('');
                
                // Texte d'introduction adapt√© au type
                let introText = '';
                if (v.type === 'aligned') {
                    introText = 'Les points semblent parfaitement align√©s sur une droite.';
                } else if (v.type === 'almost') {
                    introText = 'Les points semblent presque align√©s, avec de l√©g√®res variations.';
                } else {
                    introText = 'Les points ne semblent pas align√©s sur une droite.';
                }
                
                // Solution adapt√©e au type
                let solutionContent = '';
                if (v.type === 'aligned') {
                    solutionContent = `
                        <div class="solution-step">
                            <h4>1. Observation graphique</h4>
                            <p>${introText}</p>
                            <p><strong>Conjecture :</strong> On peut mod√©liser cette croissance par une suite arithm√©tique.</p>
                        </div>
                        <div class="solution-step">
                            <h4>2. V√©rification des diff√©rences</h4>
                            <p>Donn√©es : ${v.heights.map(h => `\\(h_${h.week} = ${h.height}\\)`).join(', ')}</p>
                            <ul>
                                ${v.diffs.map((d, i) => `<li>\\(h_${i+1} - h_${i} = ${v.heights[i+1].height} - ${v.heights[i].height} = ${d}\\)</li>`).join('')}
                            </ul>
                            <p>Les diff√©rences sont constantes et √©gales √† <strong>${v.diffs[0]} cm par semaine</strong>.</p>
                        </div>
                        <div class="solution-step">
                            <h4>3. Relation de r√©currence</h4>
                            <p>Suite arithm√©tique : \\[h_{n+1} = h_n + ${v.diffs[0]}\\] avec \\(h_0 = ${v.h0}\\) et \\(r = ${v.diffs[0]}\\).</p>
                        </div>
                        <div class="solution-step">
                            <h4>4. Pr√©vision au bout de ${v.targetWeek} semaines</h4>
                            <p>\\(h_${v.targetWeek} = ${v.h0} + ${v.targetWeek} \\times ${v.diffs[0]} = \\mathbf{${v.finalHeight}}\\) cm</p>
                        </div>
                    `;
                } else if (v.type === 'almost') {
                    // Calcul de la moyenne des diff√©rences
                    const avgDiff = Math.round(v.diffs.reduce((a,b) => a+b, 0) / v.diffs.length);
                    solutionContent = `
                        <div class="solution-step">
                            <h4>1. Observation graphique</h4>
                            <p>${introText}</p>
                            <p><strong>Conjecture :</strong> La croissance est approximativement lin√©aire (suite arithm√©tique).</p>
                        </div>
                        <div class="solution-step">
                            <h4>2. V√©rification des diff√©rences</h4>
                            <p>Donn√©es : ${v.heights.map(h => `\\(h_${h.week} = ${h.height}\\)`).join(', ')}</p>
                            <ul>
                                ${v.diffs.map((d, i) => `<li>\\(h_${i+1} - h_${i} = ${d}\\)</li>`).join('')}
                            </ul>
                            <p>Les diff√©rences sont <em>approximativement</em> constantes (autour de ${avgDiff} cm).</p>
                            <p>Les petites variations peuvent s'expliquer par des erreurs de mesure ou des conditions environnementales.</p>
                        </div>
                        <div class="solution-step">
                            <h4>3. Mod√©lisation approch√©e</h4>
                            <p>On peut mod√©liser par une suite arithm√©tique : \\[h_{n+1} \\approx h_n + ${avgDiff}\\] avec \\(h_0 = ${v.h0}\\).</p>
                            <p>C'est une <strong>approximation</strong> acceptable pour faire des pr√©visions.</p>
                        </div>
                        <div class="solution-step">
                            <h4>4. Pr√©vision au bout de ${v.targetWeek} semaines</h4>
                            <p>\\(h_${v.targetWeek} \\approx ${v.h0} + ${v.targetWeek} \\times ${avgDiff} \\approx \\mathbf{${v.h0 + v.targetWeek * avgDiff}}\\) cm</p>
                            <p>‚ö†Ô∏è Cette pr√©vision comporte une marge d'erreur due aux fluctuations observ√©es.</p>
                        </div>
                    `;
                } else {
                    // Non align√©s
                    solutionContent = `
                        <div class="solution-step">
                            <h4>1. Observation graphique</h4>
                            <p>${introText}</p>
                            <p><strong>Conjecture :</strong> Ce n'est probablement pas une suite arithm√©tique.</p>
                        </div>
                        <div class="solution-step">
                            <h4>2. V√©rification des diff√©rences</h4>
                            <p>Donn√©es : ${v.heights.map(h => `\\(h_${h.week} = ${h.height}\\)`).join(', ')}</p>
                            <ul>
                                ${v.diffs.map((d, i) => `<li>\\(h_${i+1} - h_${i} = ${d}\\)</li>`).join('')}
                            </ul>
                            <p>Les diff√©rences ne sont <strong>pas constantes</strong> : ${v.diffs.join(', ')}.</p>
                            <p>La croissance n'est donc pas lin√©aire.</p>
                        </div>
                        <div class="solution-step">
                            <h4>3. Nature de la suite</h4>
                            <p><strong>Ce n'est pas une suite arithm√©tique.</strong></p>
                            <p>On observe une croissance irr√©guli√®re (acc√©l√©rations et ralentissements altern√©s).</p>
                            <p>Un autre mod√®le (g√©om√©trique, logarithmique ou polynomial) serait plus appropri√©.</p>
                        </div>
                        <div class="solution-step">
                            <h4>4. Pr√©vision</h4>
                            <p>Il est <strong>impossible de faire une pr√©vision fiable</strong> au bout de ${v.targetWeek} semaines avec un mod√®le arithm√©tique, car le mod√®le ne correspond pas √† la r√©alit√© observ√©e.</p>
                            <p>Il faudrait identifier le v√©ritable type de croissance avant de pouvoir extrapoler.</p>
                        </div>
                    `;
                }
                
                return {
                    category: "Lecture graphique",
                    title: "Mod√©lisation √† partir d'un graphique",
                    content: `
                        <p>Un botaniste √©tudie la croissance d'une jeune pousse de ma√Øs. Il rel√®ve la hauteur de la plante chaque semaine.</p>
                        <p>Le nuage de points ci-dessous repr√©sente les mesures effectu√©es sur les 6 premi√®res semaines :</p>
                        
                        <div class="graph-container">
                            <svg width="500" height="300" viewBox="0 0 500 300" xmlns="http://www.w3.org/2000/svg">
                                <!-- Grid -->
                                <defs>
                                    <pattern id="grid" width="50" height="30" patternUnits="userSpaceOnUse">
                                        <path d="M 50 0 L 0 0 0 30" fill="none" stroke="#e2e8f0" stroke-width="1"/>
                                    </pattern>
                                </defs>
                                <rect width="500" height="300" fill="url(#grid)" />
                                
                                <!-- Axes -->
                                <line x1="50" y1="250" x2="450" y2="250" stroke="#1e293b" stroke-width="2" />
                                <line x1="50" y1="250" x2="50" y2="30" stroke="#1e293b" stroke-width="2" />
                                
                                <!-- Axis labels -->
                                <text x="250" y="280" text-anchor="middle" font-size="14" fill="#1e293b">Num√©ro de la semaine (n)</text>
                                <text x="20" y="150" text-anchor="middle" font-size="14" fill="#1e293b" transform="rotate(-90, 20, 150)">Hauteur (cm)</text>
                                
                                <!-- Ticks X -->
                                <line x1="50" y1="250" x2="50" y2="255" stroke="#1e293b" stroke-width="2"/>
                                <text x="50" y="270" text-anchor="middle" font-size="12">0</text>
                                <line x1="130" y1="250" x2="130" y2="255" stroke="#1e293b" stroke-width="2"/>
                                <text x="130" y="270" text-anchor="middle" font-size="12">1</text>
                                <line x1="210" y1="250" x2="210" y2="255" stroke="#1e293b" stroke-width="2"/>
                                <text x="210" y="270" text-anchor="middle" font-size="12">2</text>
                                <line x1="290" y1="250" x2="290" y2="255" stroke="#1e293b" stroke-width="2"/>
                                <text x="290" y="270" text-anchor="middle" font-size="12">3</text>
                                <line x1="370" y1="250" x2="370" y2="255" stroke="#1e293b" stroke-width="2"/>
                                <text x="370" y="270" text-anchor="middle" font-size="12">4</text>
                                <line x1="450" y1="250" x2="450" y2="255" stroke="#1e293b" stroke-width="2"/>
                                <text x="450" y="270" text-anchor="middle" font-size="12">5</text>
                                
                                <!-- Ticks Y dynamiques -->
                                ${ticksY}
                                
                                <!-- Points dynamiques -->
                                ${pointsSVGCorrect}
                            </svg>
                        </div>
                        <p><strong>Questions d'analyse :</strong></p>
                        <ol>
                            <li>En observant le nuage de points, les points semblent-ils align√©s ? Que peut-on conjecturer sur la nature de la suite mod√©lisant cette croissance ?</li>
                            <li>Calculer les diff√©rences de hauteur entre chaque semaine cons√©cutive : \\(h_1-h_0\\), \\(h_2-h_1\\), etc. Ces diff√©rences sont-elles constantes ?</li>
                            <li>${v.type === 'not_aligned' ? 'Expliquer pourquoi il est impossible de mod√©liser par une suite arithm√©tique.' : 'D√©terminer la relation de r√©currence de la suite \\((h_n)\\) o√π \\(h_n\\) est la hauteur au bout de \\(n\\) semaines. Pr√©ciser \\(h_0\\) et \\(r\\).'}</li>
                            <li>${v.type === 'not_aligned' ? 'Pourquoi est-il hasardeux de pr√©dire la hauteur au bout de 8 semaines ?' : `Selon ce mod√®le, quelle sera la hauteur de la plante au bout de ${v.targetWeek} semaines ? Ce mod√®le vous para√Æt-il r√©aliste sur le tr√®s long terme ?`}</li>
                        </ol>
                    `,
                    solution: solutionContent
                };
            }
        };

        function generateExerciseData(id) {
            if (generators[id]) {
                return generators[id]();
            }
            return {};
        }

        function init() {
            // G√©n√©rer toutes les valeurs al√©atoires initiales
            for (let i = 1; i <= 12; i++) {
                currentValues[i] = generateExerciseData(i);
            }
            renderSidebar();
            loadExercise(0);
        }

        function regenerateAll() {
            // R√©g√©n√©rer toutes les valeurs
            for (let i = 1; i <= 12; i++) {
                currentValues[i] = generateExerciseData(i);
            }
            // Recharger l'exercice actuel avec animation
            const slide = document.getElementById('currentSlide');
            slide.style.animation = 'none';
            setTimeout(() => {
                loadExercise(currentExercise);
                // Feedback visuel
                const indicator = document.getElementById('randomIndicator');
                indicator.style.transform = 'scale(1.2)';
                indicator.style.background = 'rgba(16, 185, 129, 0.2)';
                indicator.style.borderColor = 'var(--success)';
                indicator.innerHTML = '‚úÖ Nouvelles valeurs g√©n√©r√©es !';
                setTimeout(() => {
                    indicator.style.transform = 'scale(1)';
                    indicator.style.background = 'rgba(245, 158, 11, 0.1)';
                    indicator.style.borderColor = 'var(--accent)';
                    indicator.innerHTML = 'üé≤ Valeurs al√©atoires actives';
                }, 1000);
            }, 50);
        }

        function renderSidebar() {
            const list = document.getElementById('exerciseList');
            const titles = [
                "√âvolution d'une population de bact√©ries",
                "D√©pr√©ciation lin√©aire d'une machine",
                "√âchelonnement de dette",
                "Temp√©rature et altitude",
                "Training sportif et limites du mod√®le",
                "Vidange d'un r√©servoir",
                "Mod√©lisation possible ou non ?",
                "L'argent de poche de L√©o",
                "Location de mat√©riel",
                "Empilement de cubes",
                "Trouver la raison et le premier terme",
                "Mod√©lisation √† partir d'un graphique"
            ];
            
            list.innerHTML = titles.map((title, idx) => `
                <div class="exercise-item ${idx === 0 ? 'active' : ''}" onclick="loadExercise(${idx})" title="${title}">
                    <span class="exercise-number">Ex ${idx + 1}</span>
                    <div style="font-weight: 600; margin-bottom: 4px;">${exerciseTemplates[idx+1](currentValues[idx+1]).category}</div>
                    <div style="opacity: 0.8; font-size: 0.85rem;">${title}</div>
                </div>
            `).join('');
        }

        function loadExercise(index) {
            currentExercise = index;
            const exId = index + 1;
            const values = currentValues[exId];
            const ex = exerciseTemplates[exId](values);
            const slide = document.getElementById('currentSlide');
            
            document.querySelectorAll('.exercise-item').forEach((el, idx) => {
                el.classList.toggle('active', idx === index);
            });
            
            slide.scrollTop = 0;
            
            slide.style.animation = 'none';
            setTimeout(() => {
                slide.innerHTML = `
                    <div class="slide-header">
                        <span class="slide-category">${ex.category}</span>
                        <h2>${ex.title}</h2>
                    </div>
                    <div class="slide-content">
                        ${ex.content}
                    </div>
                `;
                
                if (window.MathJax) {
                    MathJax.typesetPromise([slide]);
                }
                
                slide.style.animation = 'fadeIn 0.4s ease';
                
                document.getElementById('btnPrev').disabled = (index === 0);
                document.getElementById('btnNext').disabled = (index === 11);
                document.getElementById('btnPrev').style.opacity = (index === 0) ? '0.5' : '1';
                document.getElementById('btnNext').style.opacity = (index === 11) ? '0.5' : '1';
            }, 50);
        }

        function nextExercise() {
            if (currentExercise < 11) {
                loadExercise(currentExercise + 1);
            }
        }

        function prevExercise() {
            if (currentExercise > 0) {
                loadExercise(currentExercise - 1);
            }
        }

        function openSolution() {
            const exId = currentExercise + 1;
            const values = currentValues[exId];
            const ex = exerciseTemplates[exId](values);
            document.getElementById('solutionContent').innerHTML = ex.solution;
            document.getElementById('solutionModal').classList.add('active');
            
            if (window.MathJax) {
                MathJax.typesetPromise([document.getElementById('solutionContent')]);
            }
        }

        function openCopyright() {
            document.getElementById('copyrightModal').classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    overlay.classList.remove('active');
                }
            });
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') nextExercise();
            if (e.key === 'ArrowLeft') prevExercise();
            if (e.key === 'Escape') {
                closeModal('solutionModal');
                closeModal('copyrightModal');
            }
        });

        window.addEventListener('load', init);
    </script>
</body>

</html>
